<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø«Ø±ÙŠØ§ Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</title>
    
    <link rel="icon" type="image/png" href="1768411699920.png">
    <link rel="apple-touch-icon" href="1768411699920.png">
    <meta name="mobile-web-app-capable" content="yes">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/darkmode.css">

    <style>
        /* --- 1. Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ù…Ù†Ø¹ Ø§Ù„ÙˆÙ…ÙŠØ¶) --- */
        #site-loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffffff; z-index: 9999999; display: flex; justify-content: center; align-items: center; flex-direction: column; transition: opacity 0.5s ease; }
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #047857; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- 2. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ (Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚Ø¯ÙŠÙ…: Ø£Ø²Ø±Ø§Ø± ØªÙØªØ­ ÙˆØªØºÙ„Ù‚) --- */
        .time-group-title {
            background: var(--bg-light); border-right: 5px solid var(--accent-color);
            padding: 10px 15px; margin: 20px 0 10px 0; font-weight: bold; color: var(--primary-color);
            border-radius: 5px; font-size: 1.1rem;
        }
        .ring-accordion-btn {
            width: 100%; text-align: right; background: white; border: 1px solid #e2e8f0;
            padding: 15px; margin-bottom: 5px; border-radius: 8px; cursor: pointer;
            font-weight: bold; display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s; color: #334155;
        }
        .ring-accordion-btn:hover { background: #f8fafc; border-color: var(--accent-color); }
        .ring-accordion-btn.active { background: var(--accent-color); color: white; border-color: var(--accent-color); }
        .ring-schedule-panel {
            display: none; padding: 10px; background: white; border: 1px solid #e2e8f0;
            border-top: none; border-radius: 0 0 8px 8px; margin-bottom: 10px; animation: slideDown 0.3s ease;
        }
        .schedule-table-simple { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .schedule-table-simple th, .schedule-table-simple td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .schedule-table-simple th { background: #f1f5f9; color: var(--primary-color); }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- 3. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† (Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ØµÙŠØ© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©) --- */
        .teacher-row {
            display: flex; align-items: center; gap: 10px; padding: 12px;
            background: white; border-bottom: 1px solid #eee; transition: 0.2s;
        }
        .teacher-row:last-child { border-bottom: none; }
        .teacher-icon { font-size: 1.2rem; color: var(--accent-color); background: #eff6ff; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .teacher-info h4 { margin: 0; font-size: 1rem; color: #333; }
        .teacher-info p { margin: 2px 0 0 0; font-size: 0.85rem; color: gray; }

        /* --- 4. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© (Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©) --- */
        .custom-dynamic-card {
            background: white; border-radius: 10px; padding: 15px; margin-bottom: 15px;
            border: 1px solid #eee; border-right-width: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }
        .custom-dynamic-card h3 { margin-top: 0; margin-bottom: 10px; }
        .custom-dynamic-card:active { transform: scale(0.98); }

        /* --- 5. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ --- */
        .popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 20000; display: none; justify-content: center; align-items: center; }
        .popup-content { background: white; padding: 30px; border-radius: 15px; max-width: 90%; width: 400px; text-align: center; border: 3px solid var(--accent-color); animation: popUp 0.4s ease; }
        .dont-show-again { margin-top: 10px; font-size: 0.8rem; color: gray; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px; }
        
        /* --- 6. ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø© --- */
        #maintenance-mode { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1e293b; color: white; z-index: 999999; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="site-loader">
        <div class="spinner"></div>
        <h3 style="color:#047857; font-family:'Amiri';">Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø«Ø±ÙŠØ§...</h3>
    </div>

    <div id="maintenance-mode">
        <h1 style="font-size: 3rem;">ğŸš§</h1>
        <h2>Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©</h2>
        <p>Ù†Ù‚ÙˆÙ… Ø¨Ø¨Ø¹Ø¶ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§ØªØŒ Ø³Ù†Ø¹ÙˆØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        <button onclick="openLoginModal()" style="margin-top:20px; background: transparent; border: 1px solid white; color: white; padding: 5px 15px; border-radius: 20px; cursor: pointer;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±Ù</button>
    </div>

    <div id="site-notification" class="popup-overlay">
        <div class="popup-content">
            <h3 id="notif-title" style="color:var(--primary-color); margin-top:0;">ğŸ“¢ ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…</h3>
            <p id="notif-body" style="font-size:1.1rem; line-height:1.6; color:#333;">...</p>
            <button onclick="closePopup()" class="nav-btn active" style="margin-top:15px; width:100%;">Ø­Ø³Ù†Ø§Ù‹ØŒ ÙÙ‡Ù…Øª âœ…</button>
            <div class="dont-show-again" onclick="disablePopupForever()">
                <input type="checkbox" id="popup-forever-check">
                <span>Ù„Ø§ ØªØ¸Ù‡Ø± Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</span>
            </div>
        </div>
    </div>
    <div id="toast-container" class="toast-container"></div>

    <header>
        <button class="theme-circle-btn" onclick="toggleTheme()" id="theme-btn" title="ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¸Ù‡Ø±">ğŸŒ™</button>
        
        <div class="video-container">
            <video id="bg-video" autoplay muted loop playsinline>
                <source src="1768472913710.mp4" type="video/mp4">
            </video>
        </div>
        
        <h1 id="txt_header_title">Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø«Ø±ÙŠØ§</h1>
        <p class="header-subtitle" id="txt_header_subtitle">Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</p>
        <p class="header-location" id="txt_header_location">Ø­Ø¶Ø±Ù…ÙˆØª - ØºÙŠÙ„ Ø¨Ø§ÙˆØ²ÙŠØ±</p>
        <div id="verse-display" class="verse-ticker"></div>
    </header>

    <div class="nav-container-wrapper">
        <button class="nav-btn-home active" onclick="showSection('home')">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <div class="nav-expand-btn" onclick="toggleNavMenu()">
            <span>Ø¨Ù‚ÙŠØ© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</span>
            <span id="nav-arrow" class="arrow-icon">â–¼</span>
        </div>
        <div id="nav-menu-grid" class="nav-grid hidden"></div>
    </div>

    <div class="container">
        
        <div id="section-home" class="page-section active">
            
            <div id="dynamic-custom-cards-container"></div>

            <div id="block-news" style="display:none;">
                <h2 style="color:var(--primary-color)" id="txt_news_title">ğŸ“¢ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h2>
                <div class="news-ticker" style="background: #f1f5f9; padding: 10px; border-bottom: 2px solid var(--primary-color); border-radius: 8px; margin-bottom: 20px;">
                    <marquee id="dynamic-news-bar" direction="right" scrollamount="6" style="font-weight: bold; color: #333; font-size: 1.1rem;">
                        â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                    </marquee>
                </div>
            </div>

            <div id="block-student" style="display:none;">
                <div class="card" style="background: linear-gradient(135deg, #fffbeb 0%, #fff 100%); border: 1px solid #fcd34d;">
                    <div style="text-align:center;">
                        <span style="font-size:2rem;">ğŸ‘‘</span>
                        <h3 style="margin:5px 0; color:#d97706;" id="txt_student_title">Ù†Ø¬Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
                        <h2 id="top-student-name" style="margin: 10px 0; color: var(--primary-color); font-size: 1.5rem;">...</h2>
                        <p id="top-student-desc" style="color: gray; font-size: 0.9rem;">...</p>
                    </div>
                </div>
            </div>

            <div id="block-question" style="display:none;">
                <h2 style="color:var(--primary-color); margin-top:25px;" id="txt_question_title">â“ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h2>
                <div class="card" style="border-right: 4px solid var(--accent-color);">
                <h3 id="weekly-question-text" style="color:var(--primary-color); margin-top:0;">...</h3>
                    <div style="background: rgba(251, 191, 36, 0.1); padding: 10px; border-radius: 8px; margin-top:10px;">
                        <strong>ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø§Ù„Ø³Ø§Ø¨Ù‚:</strong> 
                        <span id="weekly-winner-text" style="color: var(--primary-color); font-weight:bold;">...</span>
                    </div>
                    <button class="nav-btn" style="width:100%; margin-top:15px; border-color:#25D366; color:#25D366; display:flex; align-items:center; justify-content:center; gap:5px;" onclick="sendAnswerViaWhatsapp()">
                        <span>ğŸ’¬ Ø£Ø±Ø³Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© (ÙˆØ§ØªØ³Ø§Ø¨)</span>
                    </button>
                </div>
            </div>
        </div>
        <div id="section-student" class="page-section">
            <h2 style="color:var(--primary-color)">ğŸ“– Ø±ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
            <p style="text-align:center; color:gray; margin-bottom:20px;">Ø£Ø¯ÙˆØ§Øª Ø°ÙƒÙŠØ© Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø±Ø­Ù„Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</p>

            <button class="accordion-btn" onclick="loadAzkarCategories()">ğŸ“¿ Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© <span>â–¼</span></button>
            <div id="azkar-app-container" class="accordion-panel">
                <div style="padding: 15px 0;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; background:var(--bg-light); padding:10px; border-radius:8px; border:1px dashed var(--border-color);">
                        <label style="font-size:0.9rem;">ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª:</label>
                        <select id="reset-period-select" onchange="saveResetSetting()" style="padding:5px; border-radius:5px; border:1px solid var(--border-color);">
                            <option value="24">ÙƒÙ„ 24 Ø³Ø§Ø¹Ø© (ÙŠÙˆÙ…ÙŠØ§Ù‹)</option>
                            <option value="12">ÙƒÙ„ 12 Ø³Ø§Ø¹Ø©</option>
                            <option value="manual">ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙÙ‚Ø·</option>
                        </select>
                    </div>
                    <div id="azkar-categories-grid" class="button-grid"></div>
                    <div id="azkar-list-container" style="display:none; margin-top:15px;">
                        <div style="display:flex; gap:10px; margin-bottom:15px;">
                            <button class="nav-btn" onclick="backToAzkarCategories()" style="flex:1;">ğŸ”™ Ø¹ÙˆØ¯Ø©</button>
                            <button class="nav-btn" onclick="resetCategoryCounters()" style="flex:1; border-color:#ef4444; color:#ef4444;">ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„Ù‚Ø³Ù…</button>
                        </div>
                        <h3 id="azkar-category-title" style="color:var(--primary-color); text-align:center; margin-top:0;"></h3>
                        <div id="azkar-items-list"></div>
                    </div>
                    <div id="subha-interface" style="display:none; margin-top:10px;">
                        <div style="display:flex; gap:10px; align-items:stretch; margin-bottom:10px;">
                            <button class="nav-btn" onclick="backToAzkarCategories()" style="padding:0 15px; font-size:1.2rem;">ğŸ”™</button>
                            <div class="card" style="flex:1; margin:0; padding:10px 15px; display:flex; justify-content:space-between; align-items:center; border:2px solid var(--primary-color);">
                                <div style="text-align:right;">
                                    <div id="main-tasbeeh-counter" style="font-size:2.2rem; font-weight:bold; color:var(--accent-color); line-height:1;">0</div>
                                </div>
                                <div style="display:flex; flex-direction:column; gap:5px;">
                                    <button class="nav-btn" onclick="subhaAction('undo')" style="padding:2px 8px; font-size:0.75rem; border-color:#f59e0b; color:#f59e0b; min-height:auto;">ØªØ±Ø§Ø¬Ø¹</button>
                                    <button class="nav-btn" onclick="subhaAction('reset')" style="padding:2px 8px; font-size:0.75rem; border-color:#ef4444; color:#ef4444; min-height:auto;">ØªØµÙÙŠØ±</button>
                                </div>
                            </div>
                        </div>
                        <p id="current-tasbeeh-label" style="text-align:center; font-weight:bold; color:var(--primary-color); margin:5px 0; font-size:1rem;">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</p>
                        <div class="button-grid" style="grid-template-columns: repeat(3, 1fr); gap:5px; margin-bottom:10px;">
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡')">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</button>
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡')">Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</button>
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±')">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</button>
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡')">Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡</button>
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡')">Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡</button>
                            <button class="calc-btn-option tasbeeh-btn-small" onclick="setTasbeeh('Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ')">Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ</button>
                        </div>
                        <button id="big-tap-btn" class="nav-btn active" style="width:100%; height:100px; font-size:1.5rem; border-radius:15px; box-shadow:0 5px 15px rgba(4, 120, 87, 0.3); display:flex; align-items:center; justify-content:center; gap:10px;" onclick="subhaAction('count')">
                            <span>Ø§Ø¶ØºØ· Ù„Ù„Ø¹Ø¯</span> ğŸ‘†
                        </button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top:15px; border-right:4px solid #8b5cf6;">
                <h3 style="margin-top:0;">â° Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø°ÙƒÙŠ</h3>
                <div style="display:flex; gap:10px; margin-top:10px;">
                    <input type="time" id="alarm-time" class="form-input">
                    <button class="nav-btn active" onclick="setStudyAlarm()">ğŸ”” Ø¶Ø¨Ø·</button>
                </div>
            </div>
            
            <button class="accordion-btn">ğŸš€ Ø®Ø·Ø© Ø®ØªÙ…ÙŠ (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¬Ù‡Ø¯ÙŠ) <span>â–¼</span></button>
            <div class="accordion-panel">
                <div style="padding: 15px 0;">
                    <div id="calc-step-1"><p><strong>1ï¸âƒ£ ÙƒÙ… ÙŠÙˆÙ…Ø§Ù‹ ØªØ­ÙØ¸ ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ</strong></p><div id="days-buttons-container" class="button-grid"></div></div>
                    <div id="calc-step-2" style="display:none;"><p><strong>2ï¸âƒ£ ÙƒÙ… Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…ÙŠØŸ</strong></p><div id="amount-buttons-container" class="button-grid"></div><div id="custom-amount-div" style="display:none; margin-top:10px;"><input type="number" id="custom-pages" class="form-input" placeholder="Ø§ÙƒØªØ¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª"><button class="nav-btn" style="margin-top:10px; width:100%" onclick="calculatePlan(document.getElementById('custom-pages').value)">Ø§Ø­Ø³Ø¨</button></div></div>
                    <div id="calc-result" class="calc-result"></div>
                    <button id="reset-calc" class="nav-btn" style="display:none; margin-top:10px; width:100%; border-color:#ef4444; color:#ef4444;" onclick="resetCalc()">Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ ğŸ”„</button>
                </div>
            </div>

            <button class="accordion-btn">ğŸ§­ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®ØªÙ… (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆÙ‚ØªÙŠ) <span>â–¼</span></button>
            <div class="accordion-panel">
                <div style="padding: 15px 0;">
                    <div class="radio-group"><label class="radio-label"><input type="radio" name="planType" value="Ø­ÙØ¸" checked> ğŸ§  Ø®Ø·Ø© Ø­ÙØ¸</label><label class="radio-label"><input type="radio" name="planType" value="Ù‚Ø±Ø§Ø¡Ø©"> ğŸ“– Ø®Ø·Ø© Ù‚Ø±Ø§Ø¡Ø©</label></div>
                    <div class="calc-input-group"><label>ğŸ—“ï¸ Ø§Ù„Ø®ØªÙ… Ø¨Ø§Ù„Ø£ÙŠØ§Ù…:</label><select id="target-days" class="form-select"></select></div>
                    <div class="calc-input-group"><label>ğŸ“… Ø§Ù„Ø®ØªÙ… Ø¨Ø§Ù„Ø£Ø´Ù‡Ø±:</label><select id="target-months" class="form-select"></select></div>
                    <div class="calc-input-group"><label>ğŸ“† Ø§Ù„Ø®ØªÙ… Ø¨Ø§Ù„Ø³Ù†ÙˆØ§Øª:</label><select id="target-years" class="form-select"></select></div>
                    <button class="nav-btn active" style="width:100%; padding:15px;" onclick="calculateReversePlan()">âœ¨ Ø§Ø­Ø³Ø¨ Ø®Ø·ØªÙŠ</button>
                    <div id="reverse-calc-result" class="calc-result"></div>
                </div>
            </div>

            <button class="accordion-btn">ğŸ§  Ø§Ø®ØªØ¨Ø± Ø­ÙØ¸Ùƒ (Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ) <span>â–¼</span></button>
            <div class="accordion-panel">
                <div style="padding: 15px 0;">
                    <div id="quiz-controls">
                        <div class="calc-input-group"><label>Ù†Ø·Ø§Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</label><select id="quiz-juz" class="form-select" onchange="updateQuizSurahs()"></select></div>
                        <div class="calc-input-group"><label>Ø§Ù„Ø³ÙˆØ±Ø©:</label><select id="quiz-surah" class="form-select"></select></div>
                        <div class="calc-input-group"><label>Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„:</label><select id="quiz-type" class="form-select"><option value="complete">Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¢ÙŠØ©</option><option value="prev_ayah">Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</option><option value="next_ayah">Ø§Ù„Ø¢ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</option><option value="ayah_num">Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©</option><option value="page_num">Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©</option><option value="surah_name">Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©</option></select></div>
                        <button class="nav-btn active" style="width:100%;" onclick="startQuiz()">ğŸš€ Ø§Ø¨Ø¯Ø£</button>
                    </div>
                    <div id="quiz-area" class="card" style="display:none; margin-top:15px; border:2px dashed var(--primary-color);">
                        <p id="question-text" style="font-size:1.3rem; margin-bottom:20px; line-height:1.8;"></p>
                        <button id="show-answer-btn" class="nav-btn" onclick="showAnswer()">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ğŸ‘€</button>
                        <div id="answer-box" style="display:none; background:rgba(4, 120, 87, 0.05); padding:15px; border-radius:8px; margin-top:10px;">
                            <p id="answer-text" style="font-weight:bold; font-size:1.2rem; color:var(--primary-color); margin-bottom:10px;"></p>
                            <small id="answer-details" style="color:gray; display:block; margin-top:5px; border-top:1px solid #eee; padding-top:5px;"></small>
                            <div class="quiz-actions" style="margin-top:15px; display:flex; gap:10px;">
                                <button class="nav-btn" onclick="nextQuestionSameType()" style="flex:1;">Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
                                <button class="nav-btn" onclick="resetQuiz()" style="flex:1; border-color:gray; color:gray;">Ø¥Ù†Ù‡Ø§Ø¡ âŒ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="accordion-btn" onclick="openQuranApp()">ğŸ“– Ø§Ù„Ø®ØªÙ…Ø© (Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ) <span>â–¼</span></button>
            <div id="quran-app-container" class="accordion-panel" style="background: var(--bg-light);">
                <div style="padding: 15px 0;">
                    <div class="quran-header-controls"><input type="text" id="quran-search" class="form-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³ÙˆØ±Ø©..." onkeyup="filterSurahs()"><button class="nav-btn" onclick="goToBookmark()" style="font-size:0.9rem;">ğŸ”– Ø§Ø³ØªÙƒÙ…Ù„</button></div>
                    <div id="surah-grid" class="surah-grid-container"></div>
                    <div id="reading-area" style="display:none;">
                        <div class="reading-header"><button onclick="closeReading()" class="nav-btn" style="border:none;">ğŸ”™</button><h3 id="current-surah-title" style="margin:0; color:var(--primary-color); font-size:1rem;"></h3><div style="display:flex; gap:5px;"><button class="font-control-btn" onclick="changeFontSize(1)">A+</button><button class="font-control-btn" onclick="changeFontSize(-1)">A-</button></div></div>
                        <div id="bookmark-tip" style="text-align:center; font-size:0.8rem; color:gray; margin-bottom:5px; display:none;">ğŸ’¡ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© <span style="color:var(--accent-color)">ğŸ”–</span> Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¢ÙŠØ© Ù„Ø­ÙØ¸ Ù…ÙƒØ§Ù†Ùƒ</div>
                        <div id="quran-text-display" class="quran-text-content"></div>
                        <button class="nav-btn" style="width:100%; margin-top:30px; border-color:#d97706; color:#d97706;" onclick="showDuaa()">ğŸ¤² Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø®ØªÙ…</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="section-ranks" class="page-section">
            <div id="block-ranks" style="display:none;">
                <h2 style="color:var(--primary-color)">ğŸ† Ø£ÙˆØ§Ø¦Ù„ Ø§Ù„Ø­Ù„Ù‚Ø§Øª</h2>
                <div id="dynamic-ranks-list">
                    </div>
            </div>
        </div>

        <div id="section-schedule" class="page-section">
            <div id="block-schedule" style="display:none;">
                <h2 style="color:var(--primary-color)" id="txt_schedule_title">ğŸ“… Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h2>
                
                <div id="dynamic-schedule-container">
                    <p style="text-align:center; color:gray;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„...</p>
                </div>
                
                <h2 style="color:#ef4444; margin-top:25px;">ğŸ–ï¸ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</h2>
                <div class="card" style="border-right-color: #ef4444;">
                    <ul id="dynamic-holidays-list" style="margin:0; padding-right:20px;">
                        <li>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="section-teachers" class="page-section">
            <div id="block-teachers" style="display:none;">
                <h2 style="color:var(--primary-color)" id="txt_teachers_title">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ†</h2>
                <div id="dynamic-teachers-container">
                    <p style="text-align:center; color:gray;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†...</p>
                </div>
            </div>
        </div>
        
        <div id="section-myname" class="page-section">
            <h2 style="color:var(--primary-color)">ğŸ·ï¸ Ø¨Ø·Ø§Ù‚ØªÙŠ</h2>
            <div class="card">
                <p>Ø³Ø¬Ù„ Ø§Ø³Ù…Ùƒ Ù„ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„.</p>
                <div class="calc-input-group" style="margin-top:15px;">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…:</label>
                    <input type="text" id="student-name-input" class="form-input" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ..." maxlength="30">
                </div>
                <div class="calc-input-group" style="margin-top:10px;">
                    <label>Ø§Ø³Ù… Ø­Ù„Ù‚ØªÙƒ:</label>
                    <select id="student-ring-select" class="form-select">
                        <option value="">Ø§Ø®ØªØ± Ø­Ù„Ù‚ØªÙƒ...</option>
                        <option value="Ø­Ù„Ù‚Ø© Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚">Ø­Ù„Ù‚Ø© Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚</option>
                        <option value="Ø­Ù„Ù‚Ø© Ø¹Ù…Ø± Ø¨Ù† Ø§Ù„Ø®Ø·Ø§Ø¨">Ø­Ù„Ù‚Ø© Ø¹Ù…Ø± Ø¨Ù† Ø§Ù„Ø®Ø·Ø§Ø¨</option>
                        <option value="Ø­Ù„Ù‚Ø© Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†">Ø­Ù„Ù‚Ø© Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†</option>
                        <option value="Ø­Ù„Ù‚Ø© Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨">Ø­Ù„Ù‚Ø© Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨</option>
                        <option value="Ø­Ù„Ù‚Ø© Ø²ÙŠØ¯ Ø¨Ù† Ø«Ø§Ø¨Øª">Ø­Ù„Ù‚Ø© Ø²ÙŠØ¯ Ø¨Ù† Ø«Ø§Ø¨Øª</option>
                        <option value="ØºÙŠØ± Ù…Ø­Ø¯Ø¯">ØºÙŠØ± Ø°Ù„Ùƒ</option>
                    </select>
                </div>
                <button class="nav-btn active" style="width:100%; margin-top:10px; padding:12px;" onclick="saveStudentName()">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ğŸ’¾</button>
                <button class="nav-btn" style="width:100%; margin-top:10px; padding:12px; border-color:#ef4444; color:#ef4444;" onclick="deleteStudentName()">Ø­Ø°Ù ğŸ—‘ï¸</button>
                <div id="name-save-result" class="calc-result"></div>
            </div>
        </div>
        <div id="section-about" class="page-section">
            <h2 style="color:var(--primary-color)" id="txt_about_title">ğŸ•Œ Ù…Ù† Ù†Ø­Ù†</h2>
            
            <div class="card poetic-text" id="txt_about_content">
                Ù†Ø­Ù† Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø«Ø±ÙŠØ§ Ù„ØªØ­ÙÙŠØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…...
            </div>
            
            <h2 style="color:var(--primary-color)" id="txt_contact_title">ğŸ“ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
            <div class="contact-grid">
                <a href="https://wa.me/967777006546" target="_blank" class="contact-box bg-whatsapp"><span class="contact-icon">ğŸ’¬</span><span>ÙˆØ§ØªØ³Ø§Ø¨</span></a>
                <a href="https://www.instagram.com/pb8.c?igsh=MWJ3YWNobGk1NmdtZQ==" target="_blank" class="contact-box bg-insta"><span class="contact-icon">ğŸ“¸</span><span>Ø§Ù†Ø³ØªÙ‚Ø±Ø§Ù…</span></a>
                <a href="tel:+967777006546" class="contact-box bg-call"><span class="contact-icon">ğŸ“</span><span>Ø§ØªØµØ§Ù„</span></a>
                <a href="https://maps.app.goo.gl/dRRYPVJyqh2NKMg86" target="_blank" class="contact-box bg-map"><span class="contact-icon">ğŸ“</span><span>Ø§Ù„Ù…ÙˆÙ‚Ø¹</span></a>
            </div>
        </div>

        <div id="section-mobile" class="page-section">
            <h2 style="color:var(--primary-color)">ğŸ“± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
            <div class="card">Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡...</div>
        </div>

    </div> <footer id="txt_footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026</footer>

    <script src="js/data.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/quiz.js"></script>
    <script src="js/quran_app.js"></script>
    <script src="js/azkar.js"></script>
    <script src="js/logic.js"></script>

    <button onclick="openLoginModal()" style="position: fixed; bottom: 20px; left: 20px; background: #1e293b; color: white; border: 2px solid var(--primary-color); border-radius: 50%; width: 50px; height: 50px; font-size: 22px; cursor: pointer; z-index: 999999; box-shadow: 0 5px 15px rgba(0,0,0,0.3);">ğŸ”’</button>

    <div id="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000000; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
        <div style="background: white; padding: 30px; border-radius: 15px; width: 300px; text-align: center; border: 2px solid var(--primary-color);">
            <h3 style="margin-top:0; color:#1e293b;">ğŸ” Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
            <input type="text" id="admin-user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 8px; text-align:center;">
            <input type="password" id="admin-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 8px; text-align:center;">
            <button onclick="secureLogin()" style="width: 100%; padding: 12px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight:bold;">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù† ğŸš€</button>
            <button onclick="document.getElementById('login-modal').style.display='none'" style="margin-top: 15px; background: none; border: none; color: #ef4444; cursor: pointer; text-decoration: underline;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyBm8ML-1EKvQT76FJlzIQf4sn4M-MHhiRk",
          authDomain: "quran-app-93e24.firebaseapp.com",
          projectId: "quran-app-93e24",
          storageBucket: "quran-app-93e24.firebasestorage.app",
          messagingSenderId: "82150677933",
          appId: "1:82150677933:web:64213e04463c1bb3179524"
        };
        try {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();

            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Realtime)
            db.ref().on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // 1. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (ØµÙŠØ§Ù†Ø©ØŒ ÙÙŠØ¯ÙŠÙˆØŒ Ø¥Ø®ÙØ§Ø¡ Ø£Ù‚Ø³Ø§Ù…)
                    applySettings(data);
                    
                    // 2. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ù†ØµÙˆØµ
                    applyContent(data);
                    
                    // 3. Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©
                    renderComplexSchedule(data.schedule_complex); // Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                    renderTeachers(data.teachers_list_v2);        // Ø§Ù„Ù…Ø¹Ù„Ù…ÙˆÙ† (Ù†Øµ)
                    renderCustomCards(data.custom_cards);         // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                    renderRanks(data.ranks_list);                 // Ø£ÙˆØ§Ø¦Ù„ Ø§Ù„Ø­Ù„Ù‚Ø§Øª
                    renderHolidays(data.holidays_list);           // Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª

                    // 4. âœ… Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Anti-Flicker)
                    setTimeout(() => {
                        const loader = document.getElementById('site-loader');
                        if(loader) {
                            loader.style.opacity = '0';
                            setTimeout(() => loader.style.display = 'none', 500);
                        }
                    }, 800);
                }
            });

        } catch (error) { console.error(error); }

        // --- Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ---

        function applySettings(data) {
            if(!data.settings) return;
            const s = data.settings;

            // Ø£. ÙˆØ¶Ø¹ Ø§Ù„ØµÙŠØ§Ù†Ø©
            const maint = document.getElementById('maintenance-mode');
            if(s.maintenance_mode === true) {
                maint.style.display = 'flex';
                document.querySelector('.container').style.display = 'none';
                document.querySelector('header').style.display = 'none';
            } else {
                maint.style.display = 'none';
                document.querySelector('.container').style.display = 'block';
                document.querySelector('header').style.display = 'block';
            }

            // Ø¨. Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ (Ø§Ù„Ø°ÙƒÙŠØ©)
            const popup = document.getElementById('site-notification');
            const dontShow = localStorage.getItem('dont_show_popup');
            
            // ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§: (Ù…ÙØ¹Ù„ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù†) + (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù… ÙŠØ®ØªØ± "Ø¹Ø¯Ù… Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø±")
            if(s.popup_active === true && dontShow !== 'true') {
                popup.style.display = 'flex';
                document.getElementById('notif-title').innerText = s.popup_title || "ØªÙ†Ø¨ÙŠÙ‡";
                document.getElementById('notif-body').innerText = s.popup_body || "...";
            } else {
                popup.style.display = 'none';
            }

            // Ø¬. Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            toggleSection('block-news', s.show_news);
            toggleSection('block-student', s.show_student);
            toggleSection('block-question', s.show_question);
            toggleSection('block-teachers', s.show_teachers);
            toggleSection('block-schedule', s.show_schedule);
            toggleSection('block-ranks', s.show_ranks); // Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆØ§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯

            // Ø¯. Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            if(s.video_url) {
                const vid = document.getElementById('bg-video');
                if(!vid.src.includes(s.video_url)) vid.src = s.video_url;
            }
        }

        function applyContent(data) {
            // Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø³Ø¤Ø§Ù„
            if(data.news_bar) setTxt('dynamic-news-bar', data.news_bar.text);
            if(data.weekly_question) {
                setHTML('weekly-question-text', `<strong>Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:</strong> ${data.weekly_question.text}`);
                setTxt('weekly-winner-text', data.weekly_question.last_winner);
            }
            if(data.top_student) {
                setTxt('top-student-name', data.top_student.name);
                setTxt('top-student-desc', data.top_student.category);
            }
            
            // Ù†ØµÙˆØµ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù…Ù† Ù†Ø­Ù†ØŒ Ø§Ù„Ù‡ÙŠØ¯Ø±ØŒ Ø§Ù„ÙÙˆØªØ±)
            if(data.site_content) {
                const c = data.site_content;
                setTxt('txt_header_title', c.txt_header_title);
                setTxt('txt_header_subtitle', c.txt_header_subtitle);
                setTxt('txt_header_location', c.txt_header_location);
                setTxt('txt_news_title', c.txt_news_title);
                setTxt('txt_student_title', c.txt_student_title);
                setTxt('txt_question_title', c.txt_question_title);
                setTxt('txt_about_title', c.txt_about_title);
                // Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… setHTML Ù„ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø¨ÙŠØ§Øª Ø§Ù„Ø´Ø¹Ø±ÙŠØ©
                setHTML('txt_about_content', c.txt_about_content); 
                setTxt('txt_contact_title', c.txt_contact_title);
                setTxt('txt_footer', c.txt_footer);
                if(c.txt_schedule_title) setTxt('txt_schedule_title', c.txt_schedule_title);
                if(c.txt_teachers_title) setTxt('txt_teachers_title', c.txt_teachers_title);
            }
        }
        // --- 5. Ø¯ÙˆØ§Ù„ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ù‚Ø¯ (Core Logic) ---

        // Ø£. Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© (Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©)
        // Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ØªØ¨Ù†ÙŠ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙŠ ØªØ¶ÙŠÙÙ‡Ø§ Ø£Ù†Øª Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù† (ØªÙƒØ±ÙŠÙ…ØŒ Ø¯ÙˆØ±Ø§ØªØŒ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª)
        function renderCustomCards(list) {
            const container = document.getElementById('dynamic-custom-cards-container');
            if(!container) return;
            container.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ…

            if(!list) return;

            Object.values(list).forEach(card => {
                // Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù†ØŒ Ù„Ø§ Ù†Ø¹Ø±Ø¶Ù‡Ø§
                if(card.active === false) return;

                const div = document.createElement('div');
                div.className = 'custom-dynamic-card';
                // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø­Ø³Ø¨ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ±ØªÙ‡ ÙÙŠ Ø§Ù„Ø£Ø¯Ù…Ù†
                div.style.borderRightColor = card.color || '#3b82f6';
                
                let html = `<h3 style="color:${card.color || '#333'}">${card.title}</h3>`;
                html += `<p style="white-space: pre-line;">${card.text}</p>`; // pre-line Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                
                // Ø¥Ø°Ø§ Ø£Ø¶ÙØª Ø±Ø§Ø¨Ø·Ø§Ù‹ Ù„Ù„Ø²Ø±
                if(card.link) {
                    html += `<a href="${card.link}" target="_blank" class="nav-btn" style="margin-top:10px; border-color:${card.color}; color:${card.color}; width:auto; display:inline-block;">${card.btn_text || 'Ø§Ø¶ØºØ· Ù‡Ù†Ø§'}</a>`;
                }

                div.innerHTML = html;
                container.appendChild(div);
            });
        }

        // Ø¨. Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù‚Ø¯ (Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚Ø¯ÙŠÙ…: Ø¹ØµØ±/Ù…ØºØ±Ø¨ + Ø£Ø²Ø±Ø§Ø±)
        function renderComplexSchedule(data) {
            const container = document.getElementById('dynamic-schedule-container');
            if(!container) return;
            container.innerHTML = '';

            if(!data) { container.innerHTML = '<p style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ø¯Ø§ÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹</p>'; return; }

            // Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¹ØµØ± Ù‚Ø¨Ù„ Ø§Ù„Ù…ØºØ±Ø¨ (ØªØ±ØªÙŠØ¨ Ø£Ø¨Ø¬Ø¯ÙŠ Ù„Ù„Ù…ÙØ§ØªÙŠØ­: time_1, time_2)
            Object.keys(data).sort().forEach(timeKey => {
                const timeSection = data[timeKey];
                if(!timeSection.rings) return;

                // 1. Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆÙ‚Øª (Ù…Ø«Ù„Ø§Ù‹: Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø¹ØµØ±) - Ø¨Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚Ø¯ÙŠÙ…
                const timeHeader = document.createElement('div');
                timeHeader.className = 'time-group-title';
                timeHeader.innerText = timeSection.title || "ÙØªØ±Ø©";
                container.appendChild(timeHeader);

                // 2. Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø¯Ø§Ø®Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª (Ø£Ø²Ø±Ø§Ø± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙØªØ­)
                Object.values(timeSection.rings).forEach(ring => {
                    // Ø§Ù„Ø²Ø± (Accordion)
                    const btn = document.createElement('div');
                    btn.className = 'ring-accordion-btn';
                    btn.innerHTML = `<span>ğŸ“– ${ring.name}</span> <span>â–¼</span>`;
                    
                    // Ø§Ù„Ù„ÙˆØ­Ø© (Panel) Ø§Ù„Ù…Ø®ÙÙŠØ© Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                    const panel = document.createElement('div');
                    panel.className = 'ring-schedule-panel';
                    
                    // Ø±Ø³Ù… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø³Ø¨Øª -> Ø§Ù„Ø®Ù…ÙŠØ³)
                    let tableHTML = `
                        <table class="schedule-table-simple">
                            <thead><tr><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„Ù…Ù‚Ø±Ø± / Ø§Ù„Ù†Ø´Ø§Ø·</th></tr></thead>
                            <tbody>
                                <tr><td>Ø§Ù„Ø³Ø¨Øª</td><td>${ring.sat || '-'}</td></tr>
                                <tr><td>Ø§Ù„Ø£Ø­Ø¯</td><td>${ring.sun || '-'}</td></tr>
                                <tr><td>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</td><td>${ring.mon || '-'}</td></tr>
                                <tr><td>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</td><td>${ring.tue || '-'}</td></tr>
                                <tr><td>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</td><td>${ring.wed || '-'}</td></tr>
                                <tr><td>Ø§Ù„Ø®Ù…ÙŠØ³</td><td>${ring.thu || '-'}</td></tr>
                            </tbody>
                        </table>
                    `;
                    panel.innerHTML = tableHTML;

                    // Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø²Ø± Ù„Ù„ÙØªØ­ ÙˆØ§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
                    btn.onclick = function() {
                        this.classList.toggle('active');
                        if (panel.style.display === "block") {
                            panel.style.display = "none";
                            this.querySelector('span:last-child').innerText = 'â–¼';
                        } else {
                            panel.style.display = "block";
                            this.querySelector('span:last-child').innerText = 'â–²';
                        }
                    };

                    container.appendChild(btn);
                    container.appendChild(panel);
                });
            });
        }

        // Ø¬. Ø¨Ù†Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† (Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†ØµÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯)
        function renderTeachers(list) {
            const container = document.getElementById('dynamic-teachers-container');
            if(!container) return;
            container.innerHTML = '';
            
            if(!list) { container.innerHTML = '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…ÙˆÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>'; return; }

            Object.values(list).forEach(t => {
                const div = document.createElement('div');
                div.className = 'teacher-row'; // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ØªØµÙ…ÙŠÙ… CSS Ø§Ù„Ø¬Ø¯ÙŠØ¯
                
                div.innerHTML = `
                    <div class="teacher-icon"><i class="fas fa-user-tie"></i></div>
                    <div class="teacher-info">
                        <h4>${t.name}</h4>
                        <p>${t.role || 'Ù…Ø¹Ù„Ù… ÙØ§Ø¶Ù„'}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Ø¯. Ø¨Ù†Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆØ§Ø¦Ù„
        function renderRanks(list) {
            const container = document.getElementById('dynamic-ranks-list');
            if(!container) return;
            container.innerHTML = '';
            
            if(!list) { container.innerHTML = '<p>Ù„Ù… ÙŠØªÙ… Ø±ÙØ¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø¨Ø¹Ø¯</p>'; return; }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙŠÙ‚ Ù„Ù„Ø£ÙˆØ§Ø¦Ù„
            let html = '<table class="schedule-table-simple" style="width:100%"><thead><tr><th>Ø§Ù„Ù…Ø±ÙƒØ²</th><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„Ø­Ù„Ù‚Ø©</th></tr></thead><tbody>';
            Object.values(list).forEach(r => {
                let medal = '';
                if(r.rank == 1) medal = 'ğŸ¥‡';
                else if(r.rank == 2) medal = 'ğŸ¥ˆ';
                else if(r.rank == 3) medal = 'ğŸ¥‰';
                
                html += `<tr>
                    <td>${medal} ${r.rank}</td>
                    <td><strong>${r.name}</strong></td>
                    <td>${r.ring}</td>
                </tr>`;
            });
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // Ù‡Ù€. Ø¨Ù†Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
        function renderHolidays(list) {
            const ul = document.getElementById('dynamic-holidays-list');
            if(!ul) return;
            ul.innerHTML = '';
            if(!list) { ul.innerHTML = '<li>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø²Ø§Øª Ù‚Ø±ÙŠØ¨Ø©</li>'; return; }
            
            Object.values(list).forEach(h => {
                const li = document.createElement('li');
                li.innerText = h.text;
                ul.appendChild(li);
            });
        }
        // --- 6. Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© (Helpers) ---

        function setTxt(id, txt) { const el = document.getElementById(id); if(el && txt) el.innerText = txt; }
        
        // Ù†Ø³ØªØ®Ø¯Ù… innerHTML Ù‡Ù†Ø§ Ø¨Ø­Ø°Ø± (ÙÙ‚Ø· Ù„Ù„Ù†ØµÙˆØµ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªÙ†Ø³ÙŠÙ‚ Ù…Ø«Ù„ Ø§Ù„Ø£Ø¨ÙŠØ§Øª Ø§Ù„Ø´Ø¹Ø±ÙŠØ©)
        function setHTML(id, txt) { const el = document.getElementById(id); if(el && txt) el.innerHTML = txt; }

        function toggleSection(id, show) {
            const el = document.getElementById(id);
            // Ø¥Ø°Ø§ ÙƒØ§Ù† show == true Ù†Ø¹Ø±Ø¶Ù‡ØŒ ØºÙŠØ± Ø°Ù„Ùƒ Ù†Ø®ÙÙŠÙ‡
            // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ØªØ¨Ø¯Ø£ Ù…Ø®ÙÙŠØ© (display:none) Ù„Ù…Ù†Ø¹ Ø§Ù„ÙˆÙ…ÙŠØ¶
            if(el) {
                if(show === true) el.style.display = 'block';
                else el.style.display = 'none';
            }
        }

        // --- 7. Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ ---

        function closePopup() {
            document.getElementById('site-notification').style.display = 'none';
        }

        function disablePopupForever() {
            const checkbox = document.getElementById('popup-forever-check');
            if(checkbox.checked) {
                // Ø­ÙØ¸ Ø§Ù„Ø®ÙŠØ§Ø± ÙÙŠ Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…ØªØµÙØ­
                localStorage.setItem('dont_show_popup', 'true');
                alert("ØªÙ…! Ù„Ù† ØªØ¸Ù‡Ø± Ù„Ùƒ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø².");
                closePopup();
            }
        }

        // --- 8. Ø¨Ø±Ù…Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Admin) ---

        function openLoginModal() { document.getElementById('login-modal').style.display = 'flex'; }
        
        function secureLogin() {
            const u = document.getElementById('admin-user').value;
            const p = document.getElementById('admin-pass').value;
            const db = firebase.database();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            db.ref('admin_account').once('value').then(snap => {
                const creds = snap.val();
                let realU = "admin", realP = "12345"; // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                
                if(creds) { 
                    realU = creds.username; 
                    realP = creds.password; 
                }
                
                // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
                if(u === realU && p === realP) {
                    // Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    localStorage.setItem('admin_token', 'SECRET_PASS_123');
                    window.location.href = "admin.html"; // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
                } else {
                    alert("â›” Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");
                }
            }).catch(error => {
                console.error(error);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.");
            });
        }

    </script>
</body>
</html>
